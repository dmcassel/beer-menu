# Authentication Setup Instructions

This PR implements local database authentication for the Beer Menu application. Follow these steps to set up and use the authentication system.

## Database Migration

After pulling this PR, you need to run the database migration to update the schema:

```powershell
npm run db:push
```

This will:
1. Update the `role` enum to include "curator" role
2. Modify the `users` table to use username/password instead of OAuth

## Creating User Accounts

Users must be created directly in the database by the database administrator. Here's an example SQL command to create a curator user:

```sql
-- Create a curator user
INSERT INTO users (username, password_hash, name, email, role)
VALUES (
  'your_username',
  -- Password hash will be generated by the application
  -- For initial setup, you can use this example hash for password "password123"
  'salt:hash',  -- Replace with actual hash
  'Your Name',
  'your.email@example.com',
  'curator'
);
```

### Generating Password Hashes

To generate a password hash, you can use the Node.js crypto module. Run this in your Node.js environment:

```javascript
const crypto = require('crypto');

function hashPassword(password) {
  const salt = crypto.randomBytes(16).toString('hex');
  const hash = crypto.pbkdf2Sync(password, salt, 100000, 64, 'sha512').toString('hex');
  return `${salt}:${hash}`;
}

console.log(hashPassword('your_password_here'));
```

## User Roles

The system supports three roles:
- **user**: Basic user (no access to management features)
- **curator**: Can manage the beer catalog (add, edit, delete beers, breweries, styles, etc.)
- **admin**: Full administrative access (currently same as curator, but can be extended)

## Access Control

- **Public Access**: The Beer Browser (`/browser`) is accessible to everyone
- **Protected Access**: All management pages require authentication with curator or admin role:
  - `/dashboard` - Main management dashboard
  - All CRUD operations for beers, breweries, styles, BJCP categories, and menu categories

## Login

Users can log in at `/login` using their username and password. Upon successful login, they will be redirected to the dashboard.

## Testing

1. Create a test curator user in the database
2. Navigate to `/login`
3. Enter credentials
4. Verify access to the dashboard
5. Verify that unauthenticated users are redirected to login when accessing `/dashboard`
6. Verify that the Beer Browser remains publicly accessible
